<!DOCTYPE html><html lang="zh-CN,en,default"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A legendary army."><title>Javascript Closure: Typical Usages and Gotchas | Crusade</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.1.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Javascript Closure: Typical Usages and Gotchas</h1><a id="logo" href="/.">Crusade</a><p class="description">For honor!</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Javascript Closure: Typical Usages and Gotchas</h1><div class="post-meta">Nov 25, 2016<span> | </span><span class="category"><a href="/categories/Front-End/">Front End</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/11/25/javascript-closure/" href="/2016/11/25/javascript-closure/#comments" class="ds-thread-count"></a><div class="post-content"><p>You can see closures nearly everywhere in JavaScript, and this post will discuss closure. We’ll start from the definition, then some typical usages will be given and finally we’ll talk about some common mistakes with closure.</p>
<h2 id="What-is-a-Closure"><a href="#What-is-a-Closure" class="headerlink" title="What is a Closure?"></a>What is a Closure?</h2><blockquote><p>Closures are functions that refer to independent (free) variables (variables that are used locally, but defined in an enclosing scope). In other words, these functions ‘remember’ the environment in which they were created.</p>
<footer><strong>MDN</strong><cite><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures" target="_blank" rel="external">Closures</a></cite></footer></blockquote>
<p>To better understand closure, first there is something to know about lexical scope.</p>
<h3 id="Lexical-Scope-vs-Dynamic-Scope"><a href="#Lexical-Scope-vs-Dynamic-Scope" class="headerlink" title="Lexical Scope vs. Dynamic Scope"></a>Lexical Scope vs. Dynamic Scope</h3><blockquote><p>In languages with lexical scope (also called static scope), name resolution depends on the location in the source code and the lexical context, which is defined by where the named variable or function is defined. In contrast, in languages with dynamic scope the name resolution depends upon the program state when the name is encountered which is determined by the execution context or calling context.</p>
<footer><strong>Wikipedia</strong><cite><a href="https://en.wikipedia.org/wiki/Scope_(computer_science)#Lexical_scope_vs._dynamic_scope" target="_blank" rel="external">Lexical Scope vs. Dynamic Scope</a></cite></footer></blockquote>
<p>One <a href="http://stackoverflow.com/questions/1047454/what-is-lexical-scope" target="_blank" rel="external">topic</a> on stackoverflow offers two vivid examples (in C language):</p>
<p>For lexical scope:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x = <span class="number">5</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fun2</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, x);</div><div class="line">    &#125;</div><div class="line">    fun2();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>The inner function <code>func2()</code> have access to variable <code>x</code> defined in outer function <code>fun()</code>.</p>
<p>For dynamic scope:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, x);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dummy1</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x = <span class="number">5</span>;</div><div class="line"></div><div class="line">    fun();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dummy2</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x = <span class="number">10</span>;</div><div class="line"></div><div class="line">    fun();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>dummy1();</code> will print <code>5</code>, and <code>dummy2();</code> will print <code>10</code>. Dynamic scope search value according to the calling stack.</p>
<p>Javascript is based on lexical scope:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">outer</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> x = <span class="string">'outer'</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(x);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">wrapper1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> x = <span class="string">'wrapper1'</span>;</div><div class="line">        inner();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">wrapper2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> x = <span class="string">'wrapper2'</span>;</div><div class="line">        inner();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    inner();      <span class="comment">// output "outer"</span></div><div class="line">    wrapper1();   <span class="comment">// output "outer"</span></div><div class="line">    wrapper2();   <span class="comment">// output "outer"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">outer();</div></pre></td></tr></table></figure>
<p>Function <code>inner()</code> will search variable <code>x</code> in the context where it is defined, rather than the execution context.</p>
<h2 id="Typical-Usage-of-Closure"><a href="#Typical-Usage-of-Closure" class="headerlink" title="Typical Usage of Closure"></a>Typical Usage of Closure</h2><h3 id="Implement-the-Private-Variable-or-Function"><a href="#Implement-the-Private-Variable-or-Function" class="headerlink" title="Implement the Private Variable or Function"></a>Implement the Private Variable or Function</h3><p>It’s very common in SPA (single page application). For example, you need to implement a button which needs to remember how many times the user clicked. You can use closure as the callback:</p>
<iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/4o4kvhmq/embedded/js,html,result/light" frameborder="0" allowfullscreen></iframe>
<p>In the book <a href="https://www.manning.com/books/single-page-web-applications" target="_blank" rel="external"><em>Single Page Web Applications</em></a>, closures are used nearly everywhere. IIFE (Immediately Invoked Function Expression) is used to expose public API of a module, and encapsulate the private method:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">spa = (<span class="function"><span class="keyword">function</span> (<span class="params">$</span>)  </span>&#123;</div><div class="line">    <span class="keyword">var</span> var1, var2;</div><div class="line">    <span class="comment">// .. some other private variable</span></div><div class="line">    <span class="keyword">var</span> privateMethod1, privateMethod2;</div><div class="line">    <span class="comment">// .. some other private function</span></div><div class="line"></div><div class="line">    privateMethod1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">    privateMethod2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> publicMethod1, publicMethod2;</div><div class="line">    publicMethod1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">    publicMethod2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">publicMethod1</span>: publicMethod1,</div><div class="line">        <span class="attr">publicMethod2</span>: publicMethod2</div><div class="line">    &#125;;</div><div class="line">&#125;)(jQuery);</div></pre></td></tr></table></figure>
<h3 id="Currying"><a href="#Currying" class="headerlink" title="Currying"></a>Currying</h3><blockquote><p>In mathematics and computer science, currying is the technique of translating the evaluation of a function that takes multiple arguments (or a tuple of arguments) into evaluating a sequence of functions, each with a single argument.</p>
<footer><strong>Wikipedia</strong><cite><a href="https://en.wikipedia.org/wiki/Currying" target="_blank" rel="external">Currying</a></cite></footer></blockquote>
<p>To make it simple, currying is to fill the function parameters by steps, and each time generates a more specific function, calculates the value when all the parameters are filled.</p>
<p>For example, we need a <code>sum()</code> function, which take a sequece of numbers, and return the sum of them.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> total = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>, l=<span class="built_in">arguments</span>.length; i &lt; l; i++) &#123;</div><div class="line">        total += <span class="built_in">arguments</span>[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> total;</div><div class="line">&#125;</div><div class="line"></div><div class="line">sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>) <span class="comment">// 15</span></div></pre></td></tr></table></figure></p>
<p>After currying it, we can evalute it as:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sum(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">4</span>)(<span class="number">5</span>)()</div></pre></td></tr></table></figure>
<p>Here we can use closure to help remember the already filled arguments:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.currying = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">var</span> args = [];</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> self.apply(<span class="keyword">this</span>, args);</div><div class="line">        &#125;  <span class="keyword">else</span> &#123;</div><div class="line">            [].push.apply(args, <span class="built_in">arguments</span>);</div><div class="line">            <span class="keyword">return</span> <span class="built_in">arguments</span>.callee;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> sum_curried = sum.currying();</div><div class="line"></div><div class="line">sum_curried(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">4</span>)(<span class="number">5</span>)() <span class="comment">// 15</span></div></pre></td></tr></table></figure>
<p>Also The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/length" target="_blank" rel="external"><code>length</code></a> property of a function specifies the number of arguments expected by it.</p>
<p>So, we can implement currying for functions with fixed number of arguments:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.currying = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">var</span> args = [];</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        [].push.apply(args, <span class="built_in">arguments</span>);</div><div class="line">        <span class="keyword">if</span> (args.length === self.length) &#123;</div><div class="line">            <span class="keyword">return</span> self.apply(<span class="keyword">this</span>, args);</div><div class="line">        &#125;  <span class="keyword">else</span> <span class="keyword">if</span> (args.length &gt; self.length) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Too many arguments'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">arguments</span>.callee;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b, c</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a*<span class="number">100</span> + b*<span class="number">10</span> + c;</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo_curried = foo.currying();</div><div class="line">foo_curried(<span class="number">3</span>)(<span class="number">2</span>)(<span class="number">1</span>); <span class="comment">// 321</span></div></pre></td></tr></table></figure>
<h3 id="uncurrying"><a href="#uncurrying" class="headerlink" title="uncurrying"></a>uncurrying</h3><blockquote><p>Uncurrying is the dual transformation to currying, and can be seen as a form of defunctionalization. It takes a function f whose return value is another function g, and yields a new function f′ that takes as parameters the arguments for both f and g, and returns, as a result, the application of f and subsequently, g, to those arguments. The process can be iterated.</p>
<footer><strong>Wikipedia</strong><cite><a href="https://en.wikipedia.org/wiki/Currying" target="_blank" rel="external">Uncurrying</a></cite></footer></blockquote>
<p>In another sense, uncurrying is the process to make a specific function more generic: In currying, we fill part of arguments of a function and create a new more specific function; In uncurrying, we take the specific function, and unfill the already filled arguments to make it more generic. Let’s see an example.</p>
<p>The <code>push</code>, <code>shift</code>, and <code>forEach</code> methods of <code>Array.prototype</code> are only available on array objects. Often we <em>borrow</em> it from array object to help the array-like work well:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="string">'length'</span>: <span class="number">3</span>,</div><div class="line">    <span class="string">'0'</span>: <span class="string">'Apple'</span>,</div><div class="line">    <span class="string">'1'</span>: <span class="string">'Banana'</span>,</div><div class="line">    <span class="string">'2'</span>: <span class="string">'Orange'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">[].push.call(obj, <span class="string">'Lemon'</span>, <span class="string">'Kiwi'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(obj);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123; &apos;0&apos;: &apos;Apple&apos;,</div><div class="line">  &apos;1&apos;: &apos;Banana&apos;,</div><div class="line">  &apos;2&apos;: &apos;Orange&apos;,</div><div class="line">  &apos;3&apos;: &apos;Lemon&apos;,</div><div class="line">  &apos;4&apos;: &apos;Kiwi&apos;,</div><div class="line">  length: 5 &#125;</div></pre></td></tr></table></figure>
<p>Although it works, it looks very strange, and with uncurrying we can generate a generic function whose first argument is the object (the context), thus make the whole process more intuitive:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.uncurrying = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Function</span>.prototype.call.apply(self, <span class="built_in">arguments</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>, fn, ary = [<span class="string">'push'</span>, <span class="string">'shift'</span>, <span class="string">'forEach'</span>]; fn = ary[i++];) &#123;</div><div class="line">    <span class="built_in">Array</span>[fn] = <span class="built_in">Array</span>.prototype[fn].uncurrying();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now we can call them like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="string">'length'</span>: <span class="number">3</span>,</div><div class="line">    <span class="string">'0'</span>: <span class="string">'Apple'</span>,</div><div class="line">    <span class="string">'1'</span>: <span class="string">'Banana'</span>,</div><div class="line">    <span class="string">'2'</span>: <span class="string">'Orange'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Array</span>.push(obj, <span class="string">'Lemon'</span>, <span class="string">'Kiwi'</span>);</div><div class="line"><span class="built_in">console</span>.log(obj);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'\n\n'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> fruit = <span class="built_in">Array</span>.shift(obj);</div><div class="line"><span class="built_in">console</span>.log(fruit);</div><div class="line"><span class="built_in">console</span>.log(obj);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'\n\n'</span>);</div><div class="line"></div><div class="line"><span class="built_in">Array</span>.forEach(obj, <span class="function"><span class="keyword">function</span>(<span class="params">fruit</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(fruit);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&#123; <span class="string">'0'</span>: <span class="string">'Apple'</span>,</div><div class="line">  <span class="string">'1'</span>: <span class="string">'Banana'</span>,</div><div class="line">  <span class="string">'2'</span>: <span class="string">'Orange'</span>,</div><div class="line">  <span class="string">'3'</span>: <span class="string">'Lemon'</span>,</div><div class="line">  <span class="string">'4'</span>: <span class="string">'Kiwi'</span>,</div><div class="line">  <span class="attr">length</span>: <span class="number">5</span> &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Apple</div><div class="line">&#123; <span class="string">'0'</span>: <span class="string">'Banana'</span>,</div><div class="line">  <span class="string">'1'</span>: <span class="string">'Orange'</span>,</div><div class="line">  <span class="string">'2'</span>: <span class="string">'Lemon'</span>,</div><div class="line">  <span class="string">'3'</span>: <span class="string">'Kiwi'</span>,</div><div class="line">  <span class="attr">length</span>: <span class="number">4</span> &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Banana</div><div class="line">Orange</div><div class="line">Lemon</div><div class="line">Kiwi</div></pre></td></tr></table></figure>
<h3 id="Throttling"><a href="#Throttling" class="headerlink" title="Throttling"></a>Throttling</h3><p>Browser Javascript is event-drived, and the frequency of some event is too high, e.g, window resize and mouse move event. If the callbacks of these events are too time-consuming, the browser will get stuck. We can use closure to limit the frequency, and that’s <em>throttling</em>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fn, interval</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> __self = fn,</div><div class="line">        timer;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> args = <span class="built_in">arguments</span>,</div><div class="line">            __me = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (timer) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        __self.apply(__me, args);</div><div class="line"></div><div class="line">        timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            timer = <span class="literal">undefined</span>;</div><div class="line">        &#125;, interval || <span class="number">500</span>);</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The trick is whether the <code>timeoutID</code> returned by <code>setTimeout</code> is set. If it’s set, it means there is one pending excution, and we should wait. In the callback of <code>setTimeout</code>, we clear the <code>timeoutID</code> to manifest that the work is done.</p>
<p>You can paste the following code snippet into your browser’s console and play with it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.onresize = throttle(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'resize.'</span>);</div><div class="line">&#125;, <span class="number">500</span>);</div></pre></td></tr></table></figure>
<h3 id="Excution-in-chunks"><a href="#Excution-in-chunks" class="headerlink" title="Excution in chunks"></a>Excution in chunks</h3><p>Imagine you are implementing a chat application to talk to your Facebook friends and you have over 1000 friends online. If you load them at the same time, too much DOM operation will make the web page slow or even dead. Here is the point, we can separate all your friends into chunks, and add one chunk every second:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> timeChunk = <span class="function"><span class="keyword">function</span>(<span class="params">ary, fn, chunkSize, deltaTime</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> obj,</div><div class="line">        t;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> len = ary.length;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> start = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">Math</span>.min(chunkSize || <span class="number">1</span>, ary.length); ++i) &#123;</div><div class="line">            obj = ary.shift();</div><div class="line">            fn(obj);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        t = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (ary.length === <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">return</span> clearInterval(t);</div><div class="line">            &#125;</div><div class="line">            start();</div><div class="line">        &#125;, deltaTime || <span class="number">200</span>);</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The following code snippet print 2 numbers every second:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ary = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">10</span>; ++i) &#123;</div><div class="line">    ary.push(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> printElement = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> trunkPrintElements = timeChunk(ary, printElement, <span class="number">2</span>, <span class="number">1000</span>);</div><div class="line">trunkPrintElements();</div></pre></td></tr></table></figure>
<h2 id="Some-Gotchas"><a href="#Some-Gotchas" class="headerlink" title="Some Gotchas"></a>Some Gotchas</h2><p>There are still some common mistakes you’ll meet, even though closure is powerful.</p>
<h3 id="value-of-loop-variable"><a href="#value-of-loop-variable" class="headerlink" title="value of loop variable"></a>value of loop variable</h3><p>JavaScript don’t have a block scrope, so after the loop, the <code>i</code> will be <code>5</code>, and each function in <code>fArr</code> will print <code>5</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fArr = <span class="keyword">new</span> <span class="built_in">Array</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i =<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i) &#123;</div><div class="line">  fArr.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(i);&#125;);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(i) <span class="comment">// 5</span></div><div class="line">fArr[<span class="number">3</span>]() <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<p>One way to sovle this problem is to create a closure in each iteration of the loop:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fArr = <span class="keyword">new</span> <span class="built_in">Array</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i =<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i) &#123;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</div><div class="line">        fArr.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(i);&#125;);</div><div class="line">    &#125;)(i);</div><div class="line">&#125;</div><div class="line">fArr[<span class="number">3</span>]()</div></pre></td></tr></table></figure>
<p>Another solution is to use the <code>let</code> keyword in es 6, and in every iteration a new local variable <code>i</code> is created:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fArr = <span class="keyword">new</span> <span class="built_in">Array</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i =<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i) &#123;</div><div class="line">  fArr.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(i);&#125;);</div><div class="line">&#125;</div><div class="line">fArr[<span class="number">3</span>]()</div></pre></td></tr></table></figure>
<h3 id="this-issue-of-setTimeout-and-setInterval"><a href="#this-issue-of-setTimeout-and-setInterval" class="headerlink" title="this issue of setTimeout and setInterval"></a><code>this</code> issue of <code>setTimeout</code> and <code>setInterval</code></h3><p>In non-strict mode, <code>this</code> in callbacks of <code>setTimeout</code> and <code>setInterval</code> points to the <code>window</code> variable, and it’s <code>undefined</code> in strict mode. Look at the example below, we need make the bird tweak for 3 times at given frequency.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bird</span>(<span class="params">sound</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.sound = sound;</div><div class="line">&#125;</div><div class="line"></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.keepTweeking = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cnt = <span class="number">0</span>;</div><div class="line">        <span class="keyword">var</span> tid = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.getSound());</div><div class="line">            ++cnt;</div><div class="line">            <span class="keyword">if</span> (cnt == <span class="number">3</span>) clearInterval(tid);</div><div class="line">        &#125;, <span class="number">1000</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">this</span>.getSound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.sound;</div><div class="line">    &#125;;</div><div class="line">&#125;).call(Bird.prototype);</div><div class="line"></div><div class="line"><span class="keyword">var</span> bird = <span class="keyword">new</span> Bird(<span class="string">'Jiujiu~'</span>);</div><div class="line">bird.keepTweeking()</div></pre></td></tr></table></figure>
<p>It failed because <code>this</code> in the callback function of <code>setTimeout</code> is <code>window</code>, one solution to this is to use <code>bind</code> to remember <code>this</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bird</span>(<span class="params">sound</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.sound = sound;</div><div class="line">&#125;</div><div class="line"></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.keepTweeking = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cnt = <span class="number">0</span>;</div><div class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">var</span> tid = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(self.getSound());</div><div class="line">            ++cnt;</div><div class="line">            <span class="keyword">if</span> (cnt == <span class="number">3</span>) clearInterval(tid);</div><div class="line">        &#125;.bind(<span class="keyword">this</span>), <span class="number">1000</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">this</span>.getSound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.sound;</div><div class="line">    &#125;;</div><div class="line">&#125;).call(Bird.prototype);</div><div class="line"></div><div class="line"><span class="keyword">var</span> bird = <span class="keyword">new</span> Bird(<span class="string">'Jiujiu~'</span>);</div><div class="line">bird.keepTweeking()</div></pre></td></tr></table></figure>
<p>Though it’s not a problem directly related to closure, we can use closure to sovle it. Just keep <code>this</code> in variable <code>self</code>, and the callback of setInterval is a closure thus can visit <code>self</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bird</span>(<span class="params">sound</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.sound = sound;</div><div class="line">&#125;</div><div class="line"></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.keepTweeking = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> cnt = <span class="number">0</span>;</div><div class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">var</span> tid = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(self.getSound());</div><div class="line">            ++cnt;</div><div class="line">            <span class="keyword">if</span> (cnt == <span class="number">3</span>) clearInterval(tid);</div><div class="line">        &#125;, <span class="number">1000</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">this</span>.getSound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.sound;</div><div class="line">    &#125;;</div><div class="line">&#125;).call(Bird.prototype);</div><div class="line"></div><div class="line"><span class="keyword">var</span> bird = <span class="keyword">new</span> Bird(<span class="string">'Jiujiu~'</span>);</div><div class="line">bird.keepTweeking()</div></pre></td></tr></table></figure>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This post discusses JavaScript closure thoroughly. We first compares lexical scope and dynamic scope to better understand JavaScript closure, then several typical usages are given:</p>
<ol>
<li>encapsulate private variable or function</li>
<li>currying: fill arguments by steps</li>
<li>uncurrying: create a more generic function</li>
<li>throttling: control the frequency of calling a function</li>
<li>excution in chunks: separate a big task into small parts</li>
</ol>
<p>And finally some gotchas and their solutions are discussed: the loop variable and <code>this</code> in the callbacks of <code>setTimeout</code> and <code>setInterval</code>.</p>
<p>One more thing needs to be mentioned here: although closure is powerful, it did face some efficiency issue, e.g. the memory leak and creating new functions each time compared to the object-oriented paradigm. Also, too many levels of nesting is hard to understand and maintain, as the <em>zen of Python</em> puts it:</p>
<blockquote>
<p>   Flat is better than nested.</p>
</blockquote>
<p>It’s better to think twice before wielding closures.</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.sean-lan.com/2016/11/25/javascript-closure/" data-id="ciw508aba0007g1unavt214ry" class="article-share-link">分享到</a><div class="tags"><a href="/tags/JavaScript/">JavaScript</a></div><div class="post-nav"><a href="/2016/10/30/python-re-grammar/" class="next">Python re Grammar Guide</a></div><div data-thread-key="2016/11/25/javascript-closure/" data-title="Javascript Closure: Typical Usages and Gotchas" data-url="http://www.sean-lan.com/2016/11/25/javascript-closure/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/11/25/javascript-closure/" data-title="Javascript Closure: Typical Usages and Gotchas" data-url="http://www.sean-lan.com/2016/11/25/javascript-closure/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.sean-lan.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Back-End/">Back End</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Front-End/">Front End</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mobile-Application/">Mobile Application</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Django/" style="font-size: 15px;">Django</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/javascript-closure/">Javascript Closure: Typical Usages and Gotchas</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/30/python-re-grammar/">Python re Grammar Guide</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/25/python-re-quick-guide/">Quick Guide to Python re module</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/24/customize-browser-back-and-forward-button-behaviour/">Customize Browser Back and Forward Button Behavior</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/15/django-uwsgi-nginx/">Deploy Django Project in nginx with uWSGI on Mac OS X</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/12/jupyter-notebook-set-up/">Setting Up Jupyter Notebook with JavaScript, Python2 and Python3 Support</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/29/ways-to-horizontal-and-vertical-center/">Ways to Horizontally and Vertically Center Child Elements in Parent</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/ways-to-vertical-center/">Ways to Vertically Center Child Elements in Parent</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/27/ways-to-horizontal-center/">Ways to Horizontally Center Child Elements in Parent</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/04/android-permissions/">Working with Android System Permissions</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.shinexu.com/" title="Vesion" target="_blank">Vesion</a><ul></ul><a href="http://rationaldesign.studio/" title="Rational Design" target="_blank">Rational Design</a><ul></ul><a href="http://buchi.la/" title="Matt" target="_blank">Matt</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Crusade.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'stupidsean'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7a1d7b5bb01512fff50895f7b6558c95";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>