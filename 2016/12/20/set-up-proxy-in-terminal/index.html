<!DOCTYPE html><html lang="zh-CN,en,default"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A legendary army."><title>Setting Up HTTP Proxy in Terminal | Crusade</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.1.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Setting Up HTTP Proxy in Terminal</h1><a id="logo" href="/.">Crusade</a><p class="description">For honor!</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Setting Up HTTP Proxy in Terminal</h1><div class="post-meta">Dec 20, 2016<span> | </span><span class="category"><a href="/categories/Tools/">Tools</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/12/20/set-up-proxy-in-terminal/" href="/2016/12/20/set-up-proxy-in-terminal/#comments" class="ds-thread-count"></a><div class="post-content"><p>Recently, I have rent a server on <a href="https://www.aliyun.com/" target="_blank" rel="external">Aliyun</a> to set up websites and play around with web service, and it’s very exciting to have a virtual host to show some awesome stuff. However, due to some government regulations, you cannot visit some websites, invoke some web service abroad or even install some python packages if you’re in China. This post details the process of setting up a HTTP proxy in the terminal and speed up <code>git</code>, <code>pip</code>, <code>curl</code>, etc.</p>
<h2 id="Step-1-Install-Shadowsocks-Client"><a href="#Step-1-Install-Shadowsocks-Client" class="headerlink" title="Step 1: Install Shadowsocks Client"></a>Step 1: Install Shadowsocks Client</h2><p><a href="https://en.wikipedia.org/wiki/Shadowsocks" target="_blank" rel="external">Shadowsocks</a> is an open-source proxy project to help people visit some websites :). To speed up web surfing, we need to install a Shadowsocks client first.</p>
<p>For Ubuntu:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install shadowsocks</div></pre></td></tr></table></figure>
<p>For Mac:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install shadowsocks-libev</div></pre></td></tr></table></figure>
<p>You can also download a GUI client from <a href="https://sourceforge.net/projects/shadowsocksgui/" target="_blank" rel="external">https://sourceforge.net/projects/shadowsocksgui/</a></p>
<p>Create a directory named shadowsocks: <code>mkdir shadowsocks</code>, <code>cd</code> into it, create a file named <code>shadowsocks.json</code> with the following content:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"server"</span>: <span class="string">"139.162.10.88"</span>, <span class="comment">// your server ip address</span></div><div class="line">    <span class="string">"server_port"</span>: <span class="number">12345</span>,      <span class="comment">// your server port</span></div><div class="line">    <span class="string">"local_port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="string">"password"</span>: <span class="string">"your_password"</span>,</div><div class="line">    <span class="string">"timeout"</span>: <span class="number">600</span>,</div><div class="line">    <span class="string">"method"</span>: <span class="string">"aes-256-cfb"</span>    <span class="comment">// your encrption method</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Run the following command to start the Shadowshocks client:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nohup sudo nohup sslocal -c ./shadowsocks.json &amp;</div></pre></td></tr></table></figure>
<p>It’ll open a local port to wait for the connection, and here it’s <code>1080</code>.</p>
<h2 id="Step-2-Use-Shadowsocks-Client-as-HTTP-Proxy"><a href="#Step-2-Use-Shadowsocks-Client-as-HTTP-Proxy" class="headerlink" title="Step 2: Use Shadowsocks Client as HTTP Proxy"></a>Step 2: Use Shadowsocks Client as HTTP Proxy</h2><p>First, let’s do some check:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ curl ip.gs</div><div class="line">当前 IP：59.110.66.150 来自：中国北京北京 阿里云/电信/联通/移动/铁通/教育网</div></pre></td></tr></table></figure>
<p>Yes, I’m safely protected by the wall :).</p>
<p>With the environment variable <code>http_proxy</code> set, we can travel abroad:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ http_proxy=socks5://localhost:1080 curl ip.gs</div><div class="line">当前 IP：139.162.10.88 来自：新加坡新加坡 linode.com</div></pre></td></tr></table></figure>
<p>You can set it globally by:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export http_proxy=socks5://127.0.0.1:1080</div></pre></td></tr></table></figure>
<p>And stop the proxy with <code>unset http_proxy</code>.</p>
<p>Also, you can put<code>export http_proxy=socks5://127.0.0.1:1080</code> into your <code>.zshrc</code>(or, <code>.bashrc</code>) to set the <code>http_proxy</code> automatically when you start a new shell session.</p>
<p><code>source ~/.zshrc</code> or restart a new session, you can see the proxy works:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ curl ip.gs</div><div class="line">当前 IP：139.162.10.98 来自：新加坡新加坡 linode.com</div></pre></td></tr></table></figure>
<h2 id="Step-3-Set-Up-git-Proxy"><a href="#Step-3-Set-Up-git-Proxy" class="headerlink" title="Step 3: Set Up git Proxy"></a>Step 3: Set Up <code>git</code> Proxy</h2><p>First try it out:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/twbs/bootstrap.git</div></pre></td></tr></table></figure>
<p>In Aliyun, it’s quite slow. We can let git use the proxy with the following command:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config --global http.proxy &apos;socks5://127.0.0.1:1080&apos;</div></pre></td></tr></table></figure>
<p>It will create a <code>http</code> section in your <code>~/.gitconfig</code> file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[http]</div><div class="line">    proxy = socks5://127.0.0.1:1080</div></pre></td></tr></table></figure>
<p>Now, you can clone any repository in Github much faster.</p>
<h2 id="Step-4-Set-Up-pip-Proxy"><a href="#Step-4-Set-Up-pip-Proxy" class="headerlink" title="Step 4: Set Up pip Proxy"></a>Step 4: Set Up <code>pip</code> Proxy</h2><p>In Aliyun, the connection of <code>pip</code> is very slow:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ pip install tornado</div><div class="line">Collecting tornado</div><div class="line">  Downloading tornado-4.4.2.tar.gz (460kB)</div><div class="line">    4% |█▍                              | 20kB 11kB/s eta 0:00:37</div></pre></td></tr></table></figure>
<p>Also you can make it faster using proxy with <a href="https://github.com/haad/proxychains" target="_blank" rel="external"><code>proxychains</code></a>.</p>
<p>For Ubuntu:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install proxychains</div></pre></td></tr></table></figure>
<p>Change the config file at <code>/etc/proxychains.conf</code>, and change the <code>[ProxyList]</code> in it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ProxyList]</div><div class="line">socks5  127.0.0.1 1080</div></pre></td></tr></table></figure>
<p>For Mac, use <a href="https://github.com/rofl0r/proxychains-ng" target="_blank" rel="external"><code>proxychains-ng</code></a> instead:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ brew install proxychains-ng</div></pre></td></tr></table></figure>
<p>Change the config file at <code>/usr/local/etc/proxychains.conf</code>, and change the <code>[ProxyList]</code> in it like what we did for Ubuntu.</p>
<p>Now you can install packages much faster.</p>
<p>For Ubuntu, put <code>proxychains</code> before <code>pip</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ proxychains pip install tornado</div><div class="line">ProxyChains-3.1 (http://proxychains.sf.net)</div><div class="line">Collecting tornado</div><div class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.36.223:443-&lt;&gt;&lt;&gt;-OK</div><div class="line">  Downloading tornado-4.4.2.tar.gz (460kB)</div><div class="line">    51% |████████████████▍               | 235kB 553kB/s eta 0:00:01</div></pre></td></tr></table></figure>
<p>For Mac, use <code>proxychains4</code> instead:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">proxychains4 pip install Faker</div><div class="line">[proxychains] config file found: /usr/local/Cellar/proxychains-ng/4.11/etc/proxychains.conf</div><div class="line">[proxychains] preloading /usr/local/Cellar/proxychains-ng/4.11/lib/libproxychains4.dylib</div><div class="line">[proxychains] DLL init: proxychains-ng 4.11</div><div class="line">[proxychains] DLL init: proxychains-ng 4.11</div><div class="line">Collecting Faker</div><div class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  pypi.python.org:443  ...  OK</div><div class="line">  Downloading Faker-0.7.7-py2.py3-none-any.whl (562kB)</div><div class="line">    100% |████████████████████████████████| 563kB 1.3MB/s</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">Installing collected packages: Faker</div><div class="line">Successfully installed Faker-0.7.7</div></pre></td></tr></table></figure>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We can live a safe and slow life, or a “dangerous” but fast one, and Shadowsocks with all these proxy tools will help us to achieve that. Thanks all these “wanderlusters” who wallow in freedom to create these awesome stuff, and wish you a good journey with the “ladder”. Beyond the wall, there is the world.</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.sean-lan.com/2016/12/20/set-up-proxy-in-terminal/" data-id="ciwynuup0000vheun9uu2wvzv" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2016/11/25/javascript-closure/" class="pre">Javascript Closure: Typical Usages and Gotchas</a></div><div data-thread-key="2016/12/20/set-up-proxy-in-terminal/" data-title="Setting Up HTTP Proxy in Terminal" data-url="http://www.sean-lan.com/2016/12/20/set-up-proxy-in-terminal/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/12/20/set-up-proxy-in-terminal/" data-title="Setting Up HTTP Proxy in Terminal" data-url="http://www.sean-lan.com/2016/12/20/set-up-proxy-in-terminal/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.sean-lan.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Back-End/">Back End</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Front-End/">Front End</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mobile-Application/">Mobile Application</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Django/" style="font-size: 15px;">Django</a> <a href="/tags/React/" style="font-size: 15px;">React</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/12/20/set-up-proxy-in-terminal/">Setting Up HTTP Proxy in Terminal</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/javascript-closure/">Javascript Closure: Typical Usages and Gotchas</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/30/python-re-grammar/">Python re Grammar Guide</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/25/python-re-quick-guide/">Quick Guide to Python re module</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/24/customize-browser-back-and-forward-button-behaviour/">Customize Browser Back and Forward Button Behavior</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/15/django-uwsgi-nginx/">Deploy Django Project in nginx with uWSGI on Mac OS X</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/12/jupyter-notebook-set-up/">Setting Up Jupyter Notebook with JavaScript, Python2 and Python3 Support</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/29/ways-to-horizontal-and-vertical-center/">Ways to Horizontally and Vertically Center Child Elements in Parent</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/ways-to-vertical-center/">Ways to Vertically Center Child Elements in Parent</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/27/ways-to-horizontal-center/">Ways to Horizontally Center Child Elements in Parent</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.shinexu.com/" title="Vesion" target="_blank">Vesion</a><ul></ul><a href="http://rationaldesign.studio/" title="Rational Design" target="_blank">Rational Design</a><ul></ul><a href="http://buchi.la/" title="Matt" target="_blank">Matt</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Crusade.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'stupidsean'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7a1d7b5bb01512fff50895f7b6558c95";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>